# Safari 浏览器故障排除指南

## 🔍 常见问题

### 问题1：Safari无法打开页面

#### 检查步骤：

1. **确认服务器正在运行**
   ```bash
   # 检查3000端口
   netstat -ano | findstr :3000 | findstr LISTENING
   
   # 检查5000端口
   netstat -ano | findstr :5000 | findstr LISTENING
   ```

2. **确认访问地址正确**
   - 本地访问：`http://localhost:3000`
   - 网络访问：`http://[你的IP]:3000`（例如：`http://192.168.1.100:3000`）

3. **清除Safari缓存**
   - 打开Safari
   - 菜单栏 → 开发 → 清空缓存（如果没有开发菜单，先启用：Safari → 偏好设置 → 高级 → 显示开发菜单）

### 问题2：Safari显示"无法连接到服务器"

#### 解决方案：

1. **检查防火墙设置**
   - 确保Windows防火墙允许3000和5000端口
   - 或者临时关闭防火墙测试

2. **使用IP地址而不是localhost**
   - 如果使用手机Safari，必须使用IP地址
   - 获取IP地址：`ipconfig`（Windows）
   - 访问：`http://[你的IP]:3000`

3. **检查Safari安全设置**
   - Safari → 偏好设置 → 隐私
   - 取消勾选"阻止所有Cookie"（或设置为"仅来自我访问的网站"）

### 问题3：页面加载但显示空白

#### 解决方案：

1. **打开Safari开发者工具**
   - Safari → 偏好设置 → 高级 → 勾选"在菜单栏中显示开发菜单"
   - 开发 → 显示Web检查器
   - 查看控制台错误信息

2. **检查JavaScript错误**
   - 在Web检查器中查看Console标签
   - 查看是否有红色错误信息

3. **尝试硬刷新**
   - `Cmd + Shift + R`（Mac）
   - 或清除缓存后重新加载

### 问题4：API请求失败（CORS错误）

#### 解决方案：

后端已配置CORS，如果仍有问题：

1. **检查后端是否运行**
   ```bash
   cd server
   npm run dev
   ```

2. **检查API地址**
   - 前端代理配置：`/api` → `http://localhost:5000`
   - 确保后端在5000端口运行

3. **查看网络请求**
   - Safari → 开发 → 显示Web检查器 → 网络标签
   - 查看API请求是否成功

## 🛠️ 快速诊断

### 步骤1：检查服务状态

```bash
# 在项目根目录
npm run dev
```

应该看到：
- 后端：`服务器运行在 http://localhost:5000`
- 前端：`Local: http://localhost:3000/`

### 步骤2：测试后端API

在Safari中访问：
```
http://localhost:5000/api/health
```

应该返回：
```json
{"status":"ok"}
```

### 步骤3：测试前端

在Safari中访问：
```
http://localhost:3000
```

应该看到点餐页面。

## 📱 手机Safari测试

### 重要提示：

1. **必须使用IP地址，不能使用localhost**
   ```bash
   # 获取IP地址
   ipconfig
   ```

2. **确保手机和电脑在同一WiFi网络**

3. **使用正确的URL格式**
   ```
   http://192.168.1.100:3000
   ```
   （替换为你的实际IP地址）

4. **如果仍然无法访问**
   - 检查Windows防火墙设置
   - 确保Vite配置了 `host: '0.0.0.0'`（已配置）
   - 尝试关闭防火墙测试

## 🔧 Safari特定设置

### 启用开发菜单（Mac）

1. Safari → 偏好设置 → 高级
2. 勾选"在菜单栏中显示开发菜单"

### 清除网站数据

1. Safari → 偏好设置 → 隐私
2. 点击"管理网站数据"
3. 选择要清除的网站，点击"移除"

### 禁用跨站跟踪（如果影响测试）

1. Safari → 偏好设置 → 隐私
2. 取消勾选"防止跨站跟踪"（仅用于测试）

## 🌐 替代测试方法

如果Safari仍有问题，可以尝试：

1. **使用Chrome浏览器测试**
   - 通常兼容性更好
   - 访问：`http://localhost:3000`

2. **使用其他设备**
   - Android手机 + Chrome
   - 其他浏览器

3. **检查网络连接**
   - 确保设备在同一网络
   - 尝试ping电脑IP地址

## 📞 获取详细错误信息

如果问题仍然存在，请提供：

1. Safari版本
2. 操作系统版本
3. 错误信息（从Web检查器获取）
4. 访问的URL
5. 网络请求详情（从Web检查器网络标签获取）
